<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Баланс</title>
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700;800;900&family=Pixelify+Sans:wght@400..700&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="container_card">

        <!-- <pre id="tg-data"
            style="white-space: pre-wrap; word-wrap: break-word; background: #f5f5f5; padding: 10px; border: 1px solid #ccc;"></pre> -->

        <h1 class="title">Заменить мусорный пакет</h1>

        <div class="medium">Полностью заменить мусорный пакет, и поставить новый</div>

        <div class="coins-wrap">
            <div class="plus-text">
                +60
            </div>
            <div class="coins">
                <img style="z-index: 3" src="0001.avif" alt="Монета">
                <img style="z-index: 2" src="0001.avif" alt="Монета">
                <img style="z-index: 1" src="0001.avif" alt="Монета">
            </div>
        </div>
        <div class="btn">
            Выполнено
        </div>
    </div>

    <body>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const backButton = window.Telegram.WebApp.BackButton;
                backButton.show()
                backButton.onClick(() => {
                    backButton.hide();

                    window.history.back();
                });

                const current_user = {
                    id: window.Telegram.WebApp.initDataUnsafe.user.id,
                    name: window.Telegram.WebApp.initDataUnsafe.user.first_name,
                    photo_url: window.Telegram.WebApp.initDataUnsafe.user.photo_url,
                };

                const safe_area_data = {
                    safeAreaInset: window.Telegram.WebApp.safeAreaInset,
                    contentSafeAreaInset: window.Telegram.WebApp.contentSafeAreaInset
                };

                const button = document.querySelector('.btn');

                button.addEventListener('click', function () {
                    fetch('https://crasavacoin-db-default-rtdb.europe-west1.firebasedatabase.app/tasks.json', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            'action': 1,
                            'coins': 60,
                            'user_id': current_user.id
                        })
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log('Success:', data);

                            window.location.href = "/crasavacoin_app/";
                        })
                        .catch((error) => {
                            console.error('Error:', error);
                        });
                });

                // document.getElementById("tg-data").textContent += JSON.stringify(current_user, null, 2)
            })
        </script>

</html>